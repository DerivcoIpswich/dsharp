/* Script# Runtime
 * Designed and licensed for use and distribution with Script#-generated scripts.
 * Copyright (c) 2012, Nikhil Kothari, and the Script# Project.
 * More information at http://scriptsharp.com
 */
"use strict";(function(a){function b(){var j="pending",n="done",d="",f="0",i="-",g=-1,e=false,c=true,h=".",b=null;function gb(){}function l(a){return a!==b&&a!==undefined}function gc(c){for(var a=2,d=c.length;a<d;a++)if(l(c[a]))return c[a];return b}function nc(a,b){return l(a)?a:l(b)?b:gc(arguments)}function cb(c,a){for(var b in a)c[b]=a[b];return c}function Jb(c,b){for(var a in b)if(A(a,"$get_"))N(c,a.slice(5),b[a]);else if(A(a,"$set_"))O(c,a.slice(5),b[a]);else c[a]=b[a];return c}function Ab(a){return a.toLowerCase()=="true"}function Hb(a){if(a[0]=="/"){var c=a.lastIndexOf("/");if(c>1){var d=a.substring(1,c),e=a.substr(c+1);return new RegExp(d,e)}}return b}function Gb(a){return!a||!a.length?0:a.indexOf(h)>=0||a.indexOf("e")>=0||I(a,"f")||I(a,"F")?parseFloat(a):parseInt(a,10)}function Rb(b){var a=Date.parse(b);return isNaN(a)?undefined:new Date(a)}function Xb(a){return a>=0?Math.floor(a):Math.ceil(a)}function sc(){return new Date}function mc(){var a=new Date;return new Date(a.getFullYear(),a.getMonth(),a.getDate())}function xb(a,b){return a===b?c:l(a)&&l(b)?a.getTime()==b.getTime():e}function ub(a){if(!l(a.stack)||!l(a.fileName)||!l(a.lineNumber))return;var b=a.stack.split("\n"),d=b[0],f=a.fileName+":"+a.lineNumber;while(l(d)&&d.indexOf(f)===g){b.shift();d=b[0]}var e=b[1];if(!l(e))return;var c=e.match(/@(.*):(\d+)$/);if(!l(c))return;b.shift();a.stack=b.join("\n");a.fileName=c[1];a.lineNumber=parseInt(c[2],10)}function hc(e,b,c){var a=new Error(e);if(b)for(var d in b)a[d]=b[d];if(c)a.innerException=c;ub(a);return a}function pc(b){console.assert(e,b);if(a.navigator)eval("debugger;")}function P(a,b){return function(){var d=Array.prototype.slice,c=d.call(arguments,0,a);if(arguments.length==a+1&&Array.isArray(arguments[a]))c.push(arguments[a]);else{var e=d.call(arguments,a);c.push(e)}return b.apply(this,c)}}function bb(a){return a?typeof a=="string"?JSON.parse("("+a+")"):Array.prototype.slice.call(a):b}function Lb(b,d){var a=b.indexOf(d);return a>=0?(b.splice(a,1),c):e}function Nb(a){for(var b in a)delete a[b]}function Qb(b,a){return b[a]!==undefined}function L(b){if(Object.keys)return Object.keys(b);var a=[];for(var c in b)a.push(c);return a}function Ub(a){return L(a).length}function z(d,c){var a=g,e=c?c.length:d.length,f=c?function(){return{key:c[a],value:d[c[a]]}}:function(){return d[a]};this.current=b;this.moveNext=function(){a++;this.current=f();return a<e};this.reset=function(){a=g;this.current=b}}var tb={current:b,moveNext:function(){return e},reset:gb};function Ob(a){return!l(a)?tb:a.getEnumerator?a.getEnumerator():a.length!==undefined?new z(a):new z(a,L(a))}function kc(){this.count=0;this._items=[]}var fc={clear:function(){this._items.length=0;this.count=0},contains:function(b){for(var a=this.count-1;a>=0;a--)if(this._items[a]===b)return c;return e},getEnumerator:function(){return new z(this._items.reverse())},peek:function(){return this._items[this.count-1]},push:function(a){this._items.push(a);this.count++},pop:function(){if(this.count){this.count--;return this._items.pop()}return undefined}};function jc(){this.count=0;this._items=[];this._offset=0}function U(a){a._items=a._items.slice(a._offset);a._offset=0}var ec={clear:function(){this._items.length=0;this._offset=0;this.count=0},contains:function(d){for(var a=this._offset,b=this._items.length;a<=b;a++)if(this._items[a]===d)return c;return e},dequeue:function(){var a=this;if(a.count){var b=a._items[a._offset];++a._offset*2>=a._items.length&&U(a);a.count--;return b}return undefined},enqueue:function(a){this._items.push(a);this.count++},getEnumerator:function(){this._offset!=0&&U(this);return new z(this._items)},peek:function(){return this._items.length?this._items[this._offset]:undefined}};function fb(){}function y(){return Math.random()*4294967295|0}fb.NewGuid=function(){var a=255,b=y(),c=y(),d=y(),e=y(),f=k[b&a]+k[b>>8&a]+k[b>>16&a]+k[b>>24&a]+i+k[c&a]+k[c>>8&a]+i+k[c>>16&15|64]+k[c>>24&a]+i+k[d&63|128]+k[d>>8&a]+i+k[d>>16&a]+k[d>>24&a]+k[e&a]+k[e>>8&a]+k[e>>16&a]+k[e>>24&a];return f};for(var ic={},k=new Array(256),v=0;v<256;++v)k[v]=(v<16?f:d)+v.toString(16);function K(b,a){return typeof a=="number"?a>1?(new Array(a+1)).join(b):b:Array.prototype.join.call(arguments,d)}function t(a){return!a||!a.length}function Mb(a){return t(a)||!a.replace(/^\s*/,d).length}function nb(a,b,c){a=a||d,b=b||d;c?(a=a.toUpperCase(),b=b.toUpperCase()):0;return a===b?0:a<b?g:1}var lb=/(\{[^\}^\{]+\})/g,E={};function dc(b){var c=s,e=b,a=Array.prototype.slice.call(arguments,1);if(b.constructor!=String){c=b;e=a[0];a=a.slice(1)}return e.replace(lb,function(j,f){var i=parseInt(f.substr(1),10),b=a[i];if(!l(b))return d;var h=E[ab(b)];if(h){var e=d,g=f.indexOf(":");if(g>0)e=f.substring(g+1,f.length-1);if(e&&e!="i")return h(b,e,c)}return c==s?b.toString():b.toLocaleString()})}function qc(c,a){if(a||!String.prototype.trim){a=a?a.join(d):b;var e=a?new RegExp("^["+a+"]+|["+a+"]+$","g"):/^\s+|\s+$/g;return c.replace(e,d)}return c.trim()}function Sb(c,a){var b=a?new RegExp("^["+a.join(d)+"]+"):/^\s+/;return c.replace(b,d)}function cc(c,a){var b=a?new RegExp("["+a.join(d)+"]+$"):/\s+$/;return c.replace(b,d)}function A(b,a){return t(a)?c:t(b)||a.length>b.length?e:b.substr(0,a.length)==a}function I(b,a){return t(a)?c:t(b)||a.length>b.length?e:b.substr(-a.length)==a}function m(a,b,c){return a.length<b?K(c||" ",b-a.length)+a:a}function Vb(a,b,c){return a.length<b?a+K(c||" ",b-a.length):a}function Bb(b,a,c){return!c||a+c>b.length?b.substr(0,a):b.substr(0,a)+b.substr(a+c)}function zb(a,b,c){return!c?a:!b?c+a:a.substr(0,b)+c+a.substr(b)}function wb(c,b,a){return c.split(b).join(a||d)}function Z(a){var c=function(){for(var e=arguments,d=b,c=0,f=a.length;c<f;c++)d=e.length?a[c].apply(b,e):a[c].call(b);return d};c._fnList=a;return c}function oc(a,c){if(!c)return a;var f=b;a=typeof a=="string"?c[f=a]:a;var e=f?c.$$b||(c.$$b={}):b,d=e?e[f]:b;if(!d){d=function(){return a.apply(c,arguments)};if(e)e[f]=d}return d}function Yb(a,b){if(!a)return b;if(!b)return a;var c=[].concat(a._fnList||a,b);return Z(c)}function Zb(c,e){if(!c)return b;if(!e)return c;var a=c._fnList||[c],d=a.indexOf(e);if(d>=0){if(a.length==1)return b;a=d?a.slice(0,d).concat(a.slice(d+1)):a.slice(1);return Z(a)}return c}function Ib(f,g,c,d){c=c||"__"+(new Date).valueOf();d=d||a;var e={name:c,detach:function(){d[c]=gb},dispose:function(){try{delete d[c]}catch(a){d[c]=undefined}}};d[c]=g?f:function(){e.dispose();return f.apply(b,arguments)};return e}function H(){}H.Empty=new H;function mb(){this.cancel=e}function Cb(){}function S(){}function Db(){}function Pb(){}function yb(){}function Kb(){}function rb(){}function vb(){}function qb(){}function Q(a){this._parts=l(a)&&a!==d?[a]:[];this.isEmpty=this._parts.length==0}var sb={append:function(a){if(l(a)&&a!==d){this._parts.push(a);this.isEmpty=e}return this},appendLine:function(b){var a=this;a.append(b);a.append("\r\n");a.isEmpty=e;return a},clear:function(){this._parts=[];this.isEmpty=c},toString:function(a){return this._parts.join(a||d)}},C=[],ib={dispose:function(){C.pop()}};function w(a){var d=C,e=d.length;if(e){a=a||[];for(var c=0;c<e;c++){var f=d[c];a.indexOf(f)<0&&a.push(f)}return a}return b}function M(b){for(var a=0,c=b.length;a<c;a++)b[a].invalidateObserver()}function W(a){this._v=a;this._observers=b}var Fb={getValue:function(){this._observers=w(this._observers);return this._v},setValue:function(d){var a=this;if(a._v!==d){a._v=d;var c=a._observers;if(c){a._observers=b;M(c)}}}};W.registerObserver=function(a){C.push(a);return ib};function kb(a){this._items=a||[];this._observers=b}var hb={get_item:function(a){this._observers=w(this._observers);return this._items[a]},set_item:function(a,b){this._items[a]=b;this._updated()},$get_length:function(){this._observers=w(this._observers);return this._items.length},add:function(a){this._items.push(a);this._updated()},clear:function(){this._items.clear();this._updated()},contains:function(a){return this._items.indexOf(a)>=0},getEnumerator:function(){this._observers=w(this._observers);return this._items.getEnumerator()},indexOf:function(a){return this._items.indexOf(a)},insert:function(a,b){this._items.insert(a,b);this._updated()},remove:function(a){if(this._items.remove(a)){this._updated();return c}return e},removeAt:function(a){this._items.splice(a,1);this._updated()},toArray:function(){return this._items},_updated:function(){var a=this._observers;if(a){this._observers=b;M(a)}}};function r(c){var a=this;a._continuations=c!==undefined?(a.status=n,b):(a.status=j,[]);a.result=c;a.error=b}var lc={get_completed:function(){return this.status!=j},changeWith:function(b){var a=new r;this.continueWith(function(e){var c=e.error,d;if(!c)try{d=b(e)}catch(f){c=f}q(a,d,c)});return a},continueWith:function(b){var a=this;if(a._continuations)a._continuations.push(b);else{var c=a;setTimeout(function(){b(c)},0)}return a},done:function(a){return this.continueWith(function(b){b.status==n&&a(b.result)})},fail:function(a){return this.continueWith(function(b){b.status=="failed"&&a(b.error)})},then:function(a,b){return this.continueWith(function(c){c.status==n?a(c.result):b(c.error)})}};function q(a,f,e){if(a.status==j){if(e){a.error=e;a.status="failed"}else{a.result=f;a.status=n}var d=a._continuations;a._continuations=b;for(var c=0,g=d.length;c<g;c++)d[c](a)}}function X(a,k){a=bb(a);var f=a.length,g=0;if(f>1&&typeof a[0]=="number"){g=a[0];a=a.slice(1);f--}if(Array.isArray(a[0])){a=a[0];f=a.length}var d=new r,i=0;function l(a){if(d.status==j){i++;if(k)q(d,a);else i==f&&q(d,c)}}function m(){if(d.status==j)if(k)q(d,b);else q(d,e)}g!=0&&setTimeout(m,g);for(var h=0;h<f;h++)a[h].continueWith(l);return d}r.all=function(){return X(arguments,e)};r.any=function(){return X(arguments,c)};r.delay=function(b){var a=new r;setTimeout(function(){q(a,c)},b);return a};function Tb(c){var a=new r(c);return{task:a,resolve:function(b){q(a,b)},reject:function(c){q(a,b,c||new Error)}}}var s={name:d,nf:{nan:"NaN",neg:i,pos:"+",negInf:"-Infinity",posInf:"Infinity",gw:[3],dd:2,ds:h,gs:",",per:"%",perGW:[3],perDD:2,perDS:h,perGS:",",perPP:"{0} %",perNP:"-{0} %",cur:"$",curGW:[3],curDD:2,curDS:h,curGS:",",curNP:"(${0})",curPP:"${0}"},dtf:{am:"AM",pm:"PM",ds:"/",ts:":",gmt:"ddd, dd MMM yyyy HH:mm:ss 'GMT'",uni:"yyyy-MM-dd HH:mm:ssZ",sort:"yyyy-MM-ddTHH:mm:ss",dt:"dddd, MMMM dd, yyyy h:mm:ss tt",ld:"dddd, MMMM dd, yyyy",sd:"M/d/yyyy",lt:"h:mm:ss tt",st:"h:mm tt",day0:0,day:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],sday:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],mday:["Su","Mo","Tu","We","Th","Fr","Sa"],mon:["January","February","March","April","May","June","July","August","September","October","November","December",d],smon:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",d]}},pb={name:"en-us",dtf:s.dtf,nf:s.nf};function B(a,n,s,t){var g=b,m=a.indexOf(s);if(m>0){g=a.substr(m);a=a.substr(0,m)}var o=A(a,i);if(o)a=a.substr(1);var k=0,l=n[k];if(a.length<l)return g?a+g:a;var p=a.length,f=d,q=e;while(!q){var j=l,h=p-j;if(h<0){l+=h;j+=h;h=0;q=c}if(!j)break;var r=a.substr(h,j);if(f.length)f=r+t+f;else f=r;p-=j;if(k<n.length-1){k++;l=n[k]}}if(o)f=i+f;return g?f+g:f}E.Number=function(e,n,k){var b=k.nf,a=d,c=g;if(n.length>1)c=parseInt(n.substr(1));var l=n.charAt(0);switch(l){case"d":case"D":a=parseInt(Math.abs(e)).toString();if(c!=g)a=m(a,c,f);if(e<0)a=i+a;break;case"x":case"X":a=parseInt(Math.abs(e)).toString(16);if(l=="X")a=a.toUpperCase();if(c!=g)a=m(a,c,f);break;case"e":case"E":if(c==g)a=e.toExponential();else a=e.toExponential(c);if(l=="E")a=a.toUpperCase();break;case"f":case"F":case"n":case"N":if(c==g)c=b.dd;a=e.toFixed(c).toString();if(c&&b.ds!=h){var j=a.indexOf(h);a=a.substr(0,j)+b.ds+a.substr(j+1)}if(l=="n"||l=="N")a=B(a,b.gw,b.ds,b.gs);break;case"c":case"C":if(c==g)c=b.curDD;a=Math.abs(e).toFixed(c).toString();if(c&&b.curDS!=h){var j=a.indexOf(h);a=a.substr(0,j)+b.curDS+a.substr(j+1)}a=B(a,b.curGW,b.curDS,b.curGS);if(e<0)a=String.format(k,b.curNP,a);else a=String.format(k,b.curPP,a);break;case"p":case"P":if(c==g)c=b.perDD;a=(Math.abs(e)*100).toFixed(c).toString();if(c&&b.perDS!=h){var j=a.indexOf(h);a=a.substr(0,j)+b.perDS+a.substr(j+1)}a=B(a,b.perGW,b.perDS,b.perGS);if(e<0)a=String.format(k,b.perNP,a);else a=String.format(k,b.perPP,a)}return a};var D=/'.*?[^\\]'|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z/g;E.Date=function(b,d,l){if(d=="iso")return b.toISOString();else if(d.charAt(0)=="i"){var h="String";switch(d){case"id":h="DateString";break;case"it":h="TimeString"}return l==s?b["to"+h]():b["toLocale"+h]()}var e=l.dtf;if(d.length==1)switch(d){case"f":d=e.ld+" "+e.st;break;case"F":d=e.dt;break;case"d":d=e.sd;break;case"D":d=e.ld;break;case"t":d=e.st;break;case"T":d=e.lt;break;case"g":d=e.sd+" "+e.st;break;case"G":d=e.sd+" "+e.lt;break;case"R":case"r":e=s.dtf;d=e.gmt;break;case"u":d=e.uni;break;case"U":d=e.dt;b=new Date(b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate(),b.getUTCHours(),b.getUTCMinutes(),b.getUTCSeconds(),b.getUTCMilliseconds());break;case"s":d=e.sort}if(d.charAt(0)=="%")d=d.substr(1);var k=new Q;D.lastIndex=0;while(c){var n=D.lastIndex,j=D.exec(d);k.append(d.slice(n,j?j.index:d.length));if(!j)break;var g=j[0],a=g;switch(g){case"dddd":a=e.day[b.getDay()];break;case"ddd":a=e.sday[b.getDay()];break;case"dd":a=m(b.getDate().toString(),2,f);break;case"d":a=b.getDate();break;case"MMMM":a=e.mon[b.getMonth()];break;case"MMM":a=e.smon[b.getMonth()];break;case"MM":a=m((b.getMonth()+1).toString(),2,f);break;case"M":a=b.getMonth()+1;break;case"yyyy":a=b.getFullYear();break;case"yy":a=m((b.getFullYear()%100).toString(),2,f);break;case"y":a=b.getFullYear()%100;break;case"h":case"hh":a=b.getHours()%12;if(!a)a="12";else if(g=="hh")a=m(a.toString(),2,f);break;case"HH":a=m(b.getHours().toString(),2,f);break;case"H":a=b.getHours();break;case"mm":a=m(b.getMinutes().toString(),2,f);break;case"m":a=b.getMinutes();break;case"ss":a=m(b.getSeconds().toString(),2,f);break;case"s":a=b.getSeconds();break;case"t":case"tt":a=b.getHours()<12?e.am:e.pm;if(g=="t")a=a.charAt(0);break;case"fff":a=m(b.getMilliseconds().toString(),3,f);break;case"ff":a=m(b.getMilliseconds().toString(),3).substr(0,2);break;case"f":a=m(b.getMilliseconds().toString(),3).charAt(0);break;case"z":a=b.getTimezoneOffset()/60;a=(a>=0?i:"+")+Math.floor(Math.abs(a));break;case"zz":case"zzz":a=b.getTimezoneOffset()/60;a=(a>=0?i:"+")+m(Math.floor(Math.abs(a)).toString(),2,f);if(g=="zzz")a+=e.ts+m(Math.abs(b.getTimezoneOffset()%60).toString(),2,f);break;default:if(a.charAt(0)=="'")a=a.substr(1,a.length-2).replace(/\\'/g,"'")}k.append(a)}return k.toString()};var J={},u="class",x="interface";function V(f,b,g){if(Array.isArray(b)){var h=b[0],a=b[1],d=b[2],c=b[3];if(h===u){if(c){var e=function(){};e.prototype=c.prototype;a.prototype=new e;a.prototype.constructor=a}d&&Jb(a.prototype,d);a.$base=c||Object}a.$name=f;return g[f]=a}return b}function p(a,b,c,e,d){a.$type=u;a.$constructorParams=c;a.$interfaces=d;return[u,a,b,e]}function o(a,b){a.$type=x;a.$interfaces=b;return[x,a]}function N(b,a,d){Object.defineProperty(b,a,{configurable:c,"get":d})}function O(b,a,d){Object.defineProperty(b,a,{configurable:c,"set":d})}function bc(a){return a.$type==u}function Eb(a){return a.$type==x}function eb(b){var a;try{a=b.constructor}catch(c){}return a||Object}function rc(d){var c=d.indexOf(h),e=c>0?J[d.substr(0,c)]:a,f=c>0?d.substr(c+1):d;return e?e[f]:b}var G=[Number,"Number",String,"String",Boolean,"Boolean",Array,"Array",Date,"Date",RegExp,"RegExp",Function,"Function"];function ab(a){if(!(a instanceof Function))a=a.constructor;if(a.$name)return a.$name;if(a.name)return a.name;for(var b=0,c=G.length;b<c;b+=2)if(a==G[b])return G[b+1];return"Object"}function Y(b,d){if(b==Object||b==d)return c;if(b.$type==u){var a=d.$base;while(a){if(b==a)return c;a=a.$base}}else if(b.$type==x){var a=d;while(a){if(T(a,b))return c;a=a.$base}}return e}function T(f,d){if(f==d)return c;var a=f.$interfaces;if(a)for(var b=0,g=a.length;b<g;++b)if(T(a[b],d))return c;return e}function F(b,a){if(!l(a))return e;if(b==Object||a instanceof b)return c;var d=eb(a);return Y(b,d)}function ac(a,b){return F(b,a)}function Wb(a,c){return F(c,a)?a:b}function db(e,b,c){var d=J[e]={$name:e},f={};if(c)for(var a in c)f[a]=V(a,c[a],d);if(b)for(var a in b)V(a,b[a],d);return f}function R(c,a){var b=c.$base;return Object.getOwnPropertyDescriptor(b.prototype,a)||R(b,a)}function jb(a){return a.$constructorParams}function ob(d,c){var b=d.prototype,a=Object.create(b);b.constructor.apply(a,c);return a}return cb(db("ss",b,{IDisposable:o(Cb),IEnumerable:o(S),IEnumerator:o(Db),IObserver:o(Pb),IApplication:o(yb),IContainer:o(Kb),IObjectFactory:o(rb),IEventManager:o(vb),IInitializable:o(qb),EventArgs:p(H,{},[],b),CancelEventArgs:p(mb,{},[],b),StringBuilder:p(Q,sb,[],b),Stack:p(kc,fc,[],b),Queue:p(jc,ec,[],b),Observable:p(W,Fb,[],b),ObservableCollection:p(kb,hb,[],b,[S]),Task:p(r,lc,[],b),Guid:p(fb,ic,[],b)}),{version:"1.0",isValue:l,value:nc,extend:cb,keys:L,keyCount:Ub,keyExists:Qb,clearKeys:Nb,enumerate:Ob,array:bb,remove:Lb,"boolean":Ab,regexp:Hb,number:Gb,date:Rb,truncate:Xb,now:sc,today:mc,compareDates:xb,error:hc,string:K,emptyString:t,whitespace:Mb,format:dc,compareStrings:nb,startsWith:A,endsWith:I,padLeft:m,padRight:Vb,trim:qc,trimStart:Sb,trimEnd:cc,insertString:zb,removeString:Bb,replaceString:wb,bind:oc,bindAdd:Yb,bindSub:Zb,bindExport:Ib,deferred:Tb,paramsGenerator:P,createPropertyGet:N,createPropertySet:O,module:db,modules:J,isClass:bc,isInterface:Eb,typeOf:eb,type:rc,typeName:ab,canCast:ac,safeCast:Wb,canAssign:Y,instanceOf:F,baseProperty:R,defineClass:p,defineInterface:o,getConstructorParams:jb,createInstance:P(1,ob),culture:{neutral:s,current:pb},fail:pc})}function c(){var c=b();typeof exports=="object"?c.extend(exports,c):(a.ss=c)}a.define?a.define("ss",[],b):c()})(this);